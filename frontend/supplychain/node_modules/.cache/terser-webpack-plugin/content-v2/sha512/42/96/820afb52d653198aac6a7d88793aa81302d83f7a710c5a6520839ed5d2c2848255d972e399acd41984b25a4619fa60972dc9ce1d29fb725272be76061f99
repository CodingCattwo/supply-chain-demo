{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4771a487\"],{\"0e6d\":function(t,e,i){\"use strict\";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",[i(\"div\",{staticClass:\"create-form\"},[i(\"el-form\",{ref:\"dynamicValidateForm\",staticClass:\"demo-dynamic\",attrs:{model:t.dynamicValidateForm,rules:t.createRules,\"label-width\":\"100px\"}},[i(\"el-form-item\",{attrs:{prop:\"title\",label:\"标题\"}},[i(\"el-input\",{model:{value:t.dynamicValidateForm.title,callback:function(e){t.$set(t.dynamicValidateForm,\"title\",e)},expression:\"dynamicValidateForm.title\"}})],1),i(\"el-form-item\",{attrs:{prop:\"desc\",label:\"描述\"}},[i(\"el-input\",{model:{value:t.dynamicValidateForm.desc,callback:function(e){t.$set(t.dynamicValidateForm,\"desc\",e)},expression:\"dynamicValidateForm.desc\"}})],1),t._l(t.dynamicValidateForm.itemList,(function(e,a){return i(\"el-form-item\",{key:e.key,staticClass:\"demo-form-inline\",attrs:{label:\"参与方\"+a}},[i(\"el-row\",[i(\"el-col\",{attrs:{span:8}},[i(\"el-form-item\",{attrs:{label:\"\",prop:\"itemList.\"+a+\".role\",rules:t.createRules.role}},[i(\"el-input\",{attrs:{placeholder:\"角色\"},model:{value:e.role,callback:function(i){t.$set(e,\"role\",i)},expression:\"chain.role\"}})],1)],1),i(\"el-col\",{attrs:{span:8}},[i(\"el-form-item\",{attrs:{label:\"\",prop:\"itemList.\"+a+\".portion\",rules:t.createRules.portion}},[i(\"el-input\",{attrs:{type:\"number\",maxlength:\"2\",placeholder:\"份额\"},model:{value:e.portion,callback:function(i){t.$set(e,\"portion\",i)},expression:\"chain.portion\"}},[i(\"template\",{slot:\"append\"},[t._v(\"%\")])],2)],1)],1),i(\"el-col\",{attrs:{span:7}},[i(\"el-form-item\",{attrs:{label:\"\",prop:\"itemList.\"+a+\".id\",rules:t.createRules.id}},[i(\"el-select\",{attrs:{placeholder:\"参与者\",disabled:e.isSelect},model:{value:e.id,callback:function(i){t.$set(e,\"id\",i)},expression:\"chain.id\"}},[t._l(t.roleList,(function(t){return i(\"el-option\",{key:t.id,attrs:{label:t.orgName,value:t.id}})}))],2)],1)],1),i(\"el-col\",{attrs:{span:1}},[e.isSelect?t._e():i(\"div\",{staticStyle:{\"padding-left\":\"5px\"}},[i(\"el-button\",{attrs:{type:\"text\"},on:{click:function(i){return t.removeChain(e)}}},[t._v(\"移除\")])],1)])],1)],1)})),i(\"el-form-item\",[i(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(e){return t.submitForm(\"dynamicValidateForm\")}}},[t._v(\"提交\")]),i(\"el-button\",{on:{click:t.addChain}},[t._v(\"新增\")])],1)],2)],1)])},n=[],r=i(\"2909\"),l=(i(\"a15b\"),i(\"ac1f\"),i(\"1276\"),i(\"159b\"),i(\"13d5\"),i(\"d3b7\"),i(\"6062\"),i(\"3ca3\"),i(\"ddb0\"),i(\"a434\"),i(\"5f87\")),o=i(\"ad8f\"),c=i(\"c64e\"),s=i.n(c),d={data:function(){var t=function(t,e,i){var a=/^([1]?\\d{1,2})$/;a.test(e)?i():i(new Error(\"请输入1-100之间整数\"))};return{createRules:{title:[{required:!0,message:\"请输入标题\",trigger:\"blur\"}],desc:[{required:!0,message:\"请输入描述\",trigger:\"blur\"}],role:[{required:!0,message:\"请输入角色\",trigger:\"blur\"}],portion:[{validator:t,trigger:\"blur\"}],id:[{required:!0,message:\"请选择参与者\",trigger:\"blur\"}]},test:\"\",roleList:[],level:1,nextUuid:\"\",dynamicValidateForm:{itemList:[{id:\"\",role:\"\",portion:\"\",itemId:this.createUuid(),levelOnChain:0,isSelect:!0,participaterId:\"\"}],title:\"\",userId:\"\"}}},created:function(){this.getSeletData()},methods:{createUuid:function(){var t=s()();return t=t.split(\"-\").join(\"\"),t},getSeletData:function(){var t=this,e=Object(l[\"c\"])(),i=Object(l[\"a\"])();this.dynamicValidateForm.userId=e,this.preUuid=this.dynamicValidateForm.itemList[0].itemId,Object(o[\"f\"])().then((function(e){t.roleList=e.data,t.roleList.forEach((function(e){e.id==i&&(t.dynamicValidateForm.itemList[0].id=e.id)}))}))},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log(\"error submit!!\"),!1;var i=e.dynamicValidateForm.itemList,a=i.reduce((function(t,e){return parseFloat(e.portion)+parseFloat(t)}),0);if(100!==a)e.$message({message:\"请输入正确的份额\",type:\"warning\"});else{var n=[];i.forEach((function(t){n.push(t.id)}));var l=Object(r[\"a\"])(new Set(n));if(n.length!==l.length)return void e.$message({message:\"参与者不能重复选择\",type:\"error\"});e.dynamicValidateForm.itemList.forEach((function(t,e){t.participaterId=t.id,t.levelOnChain=e})),console.log(e.dynamicValidateForm),Object(o[\"c\"])(e.dynamicValidateForm).then((function(t){0===t.code&&e.$confirm(\"提交成功\",\"提交成功\",{confirmButtonText:\"返回\",type:\"success\",showCancelButton:!1,closeOnClickModal:!1}).then((function(){e.$router.push({path:\"/list\"})}))}))}}))},resetForm:function(t){this.$refs[t].resetFields()},removeChain:function(t){var e=this.dynamicValidateForm.itemList.indexOf(t);if(console.log(this.dynamicValidateForm.itemList.length-1),console.log(e),e!==this.dynamicValidateForm.itemList.length-1){var i=this.dynamicValidateForm.itemList[e-1];this.dynamicValidateForm.itemList[e+1].lastItemId=i.itemId}-1!==e&&this.dynamicValidateForm.itemList.splice(e,1)},addChain:function(){this.dynamicValidateForm.itemList.push({participaterId:\"\",role:\"\",portion:\"\",itemId:this.createUuid(),lastItemId:this.preUuid,isSelect:!1});var t=this.dynamicValidateForm.itemList.length-1;this.preUuid=this.dynamicValidateForm.itemList[t].itemId,console.log(this.dynamicValidateForm.itemList)}}},u=d,m=(i(\"b8cc\"),i(\"2877\")),p=Object(m[\"a\"])(u,a,n,!1,null,null,null);e[\"default\"]=p.exports},ad8f:function(t,e,i){\"use strict\";i.d(e,\"e\",(function(){return n})),i.d(e,\"d\",(function(){return r})),i.d(e,\"b\",(function(){return l})),i.d(e,\"f\",(function(){return o})),i.d(e,\"c\",(function(){return c})),i.d(e,\"g\",(function(){return s})),i.d(e,\"a\",(function(){return d})),i.d(e,\"j\",(function(){return u})),i.d(e,\"h\",(function(){return m})),i.d(e,\"i\",(function(){return p}));var a=i(\"b775\");i(\"5f87\");function n(t){return Object(a[\"a\"])({url:\"/supplychain/chain/\"+t,method:\"get\"})}function r(t){return Object(a[\"a\"])({url:\"/supplychain/chain/join/\"+t,method:\"get\"})}function l(t){return Object(a[\"a\"])({url:\"/supplychain/chain/checkSign/\"+t,method:\"get\"})}function o(){return Object(a[\"a\"])({url:\"/supplychain/participater/list\",method:\"get\"})}function c(t){return Object(a[\"a\"])({url:\"/supplychain/chain/new\",method:\"post\",data:t})}function s(t){return Object(a[\"a\"])({url:\"/supplychain/chain/getInfo/\"+t,method:\"get\"})}function d(t){return Object(a[\"a\"])({url:\"/supplychain/chain/sign\",method:\"post\",data:t})}function u(t){return Object(a[\"a\"])({url:\"/supplychain/chain/pay\",method:\"post\",data:t})}function m(){return Object(a[\"a\"])({url:\"/supplychain/user/getUnLoginTotalInfo\",method:\"get\"})}function p(t){return Object(a[\"a\"])({url:\"/supplychain/user/\"+t,method:\"get\"})}},b8cc:function(t,e,i){\"use strict\";i(\"c536\")},c536:function(t,e,i){}}]);","extractedComments":[]}