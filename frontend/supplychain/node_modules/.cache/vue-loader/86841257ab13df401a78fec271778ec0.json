{"remainingRequest":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/src/views/dashboard/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/src/views/dashboard/index.vue","mtime":1623815030939},{"path":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lannywu/A2021/06/0616/supply-chain-demo/frontend/supplychain/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldExpc3QsIGNoZWNrU2lnbiB9IGZyb20gIkAvYXBpL3RhYmxlIjsKaW1wb3J0IHsgZ2V0VXNlcklkIH0gZnJvbSAiQC91dGlscy9hdXRoIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBmaWx0ZXJzOiB7CiAgICBzdGF0dXNGaWx0ZXIoc3RhdHVzKSB7CiAgICAgIGNvbnN0IHN0YXR1c01hcCA9IHsKICAgICAgICBwdWJsaXNoZWQ6ICJzdWNjZXNzIiwKICAgICAgICBkcmFmdDogImdyYXkiLAogICAgICAgIGRlbGV0ZWQ6ICJkYW5nZXIiCiAgICAgIH07CiAgICAgIHJldHVybiBzdGF0dXNNYXBbc3RhdHVzXTsKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0OiBudWxsLAogICAgICBsaXN0TG9hZGluZzogdHJ1ZSwKICAgICAgc3VwcGxpZXJEYXRhOiBbXSwKICAgICAgZGlhbG9nU3VwcGxpZXJWaXNpYmxlOiBmYWxzZSwKICAgICAgZGlhbG9nU2lnblZpc2libGU6IGZhbHNlLAogICAgICBzaWduRGF0YTogewogICAgICAgIG5lZWRTaWduT3JnTmFtZXM6IFtdLAogICAgICAgIHNpZ25lZE9yZ05hbWVzOiBbXQogICAgICB9LAogICAgICBuZWVkU2lnbkNvdW50OiAiIiwKICAgICAgc2lnbmVkQ291bnQ6ICIiCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2hEYXRhKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjcmVhdGVDaGFpbigpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9saXN0L2NyZWF0ZSIpOwogICAgfSwKICAgIGhhbmRsZVNpZ24oaW5kZXgsIHJvdykgewogICAgICBjb25zdCB7IGNoYWluSWQgfSA9IHJvdzsKICAgICAgY2hlY2tTaWduKGNoYWluSWQpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuZGlhbG9nU2lnblZpc2libGUgPSB0cnVlOwogICAgICAgIHRoaXMuc2lnbkRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMubmVlZFNpZ25Db3VudCA9IHRoaXMuc2lnbkRhdGEubmVlZFNpZ25PcmdOYW1lcy5sZW5ndGg7CiAgICAgICAgdGhpcy5zaWduZWRDb3VudCA9IHRoaXMuc2lnbkRhdGEuc2lnbmVkT3JnTmFtZXMubGVuZ3RoOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVTdXBwbGllcihpbmRleCwgcm93KSB7CiAgICAgIHRoaXMuZGlhbG9nU3VwcGxpZXJWaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5zdXBwbGllckRhdGEgPSByb3cuaXRlbUxpc3Q7CiAgICB9LAogICAgZmV0Y2hEYXRhKCkgewogICAgICBjb25zdCBpZCA9IGdldFVzZXJJZCgpOwogICAgICB0aGlzLmxpc3RMb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0TGlzdChpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5saXN0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB0aGlzLmxpc3RMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8IA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/dashboard","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"btn-top\">\n      <el-button @click=\"createChain\" type=\"primary\" plain>新建</el-button>\n    </div>\n    <el-table\n      v-loading=\"listLoading\"\n      :data=\"list\"\n      element-loading-text=\"Loading\"\n    >\n      <el-table-column align=\"center\" label=\"序号\" width=\"95\">\n        <template slot-scope=\"scope\">\n          {{ scope.$index }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"公司名\" width=\"190\" show-overflow-tooltip>\n        <template slot-scope=\"scope\">\n          {{ scope.row.orgName }}\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"链名称\"\n        width=\"110\"\n        align=\"center\"\n        show-overflow-tooltip\n      >\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.title }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"描述\"\n        width=\"110\"\n        align=\"center\"\n        show-overflow-tooltip\n      >\n        <template slot-scope=\"scope\">\n          {{ scope.row.desc }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"状态\" width=\"80\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <div v-if=\"scope.row.status == 'confirmed'\">\n            <el-tag size=\"small\">已确认</el-tag>\n          </div>\n          <div v-else>\n            <el-tag type=\"info\" size=\"small\">草稿</el-tag>\n          </div>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"合约地址\" width=\"360\" align=\"center\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.contractAddress }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"存证KEY\" width=\"360\" align=\"center\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.evidenceKey }}\n        </template>\n      </el-table-column>\n      <!-- <el-table-column label=\"查看供应商\" width=\"110\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            @click=\"handleSupplier(scope.$index, scope.row)\"\n            >查看</el-button\n          >\n        </template>\n      </el-table-column> -->\n      <el-table-column label=\"操作\" width=\"210\" align=\"center\" fixed=\"right\">\n        <template slot-scope=\"scope\">\n          <a class=\"btn-link\" @click=\"handleSupplier(scope.$index, scope.row)\"\n            >查看参与方</a\n          ><span class=\"individer-line\">|</span>\n          <a class=\"btn-link\" @click=\"handleSign(scope.$index, scope.row)\"\n            >查看签名状态</a\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-dialog title=\"供应商信息\" :visible.sync=\"dialogSupplierVisible\">\n      <el-table :data=\"supplierData\">\n        <el-table-column\n          property=\"participaterDidId\"\n          label=\"参与者数字身份\"\n          width=\"\"\n        ></el-table-column>\n        <el-table-column\n          property=\"participaterOrgName\"\n          label=\"参与者公司名\"\n          width=\"200\"\n          show-overflow-tooltip\n        ></el-table-column>\n        <el-table-column label=\"分成比例\" width=\"90\">\n          <template slot-scope=\"scope\"\n            >{{ scope.row.portion }}%</template\n          ></el-table-column\n        >\n        <el-table-column\n          property=\"role\"\n          width=\"100\"\n          label=\"角色\"\n          show-overflow-tooltip\n        ></el-table-column>\n      </el-table>\n    </el-dialog>\n    <!-- 签名状态弹框 -->\n    <el-dialog\n      title=\"签名状态\"\n      :visible.sync=\"dialogSignVisible\"\n      width=\"30%\"\n      class=\"sign-box\"\n    >\n      <div class=\"content\">\n        <el-divider content-position=\"left\"\n          ><i class=\"el-icon-check\"></i>已签名({{ signedCount }})</el-divider\n        >\n        <div class=\"list\">\n          <template v-if=\"signData.signedOrgNames\">\n            <span v-for=\"item in signData.signedOrgNames\" :key=\"item\">\n              <span>{{ item }}</span>\n              <el-divider direction=\"vertical\"></el-divider\n            ></span>\n          </template>\n        </div>\n        <el-divider content-position=\"left\" class=\"need-sign-title\"\n          ><i class=\"el-icon-edit\"></i>需要签名({{ needSignCount }})</el-divider\n        >\n        <span\n          class=\"list\"\n          v-for=\"(item, index) in signData.needSignOrgNames\"\n          :key=\"index\"\n        >\n          <span>{{ item }}</span>\n          <el-divider direction=\"vertical\"></el-divider>\n        </span>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { getList, checkSign } from \"@/api/table\";\nimport { getUserId } from \"@/utils/auth\";\n\nexport default {\n  filters: {\n    statusFilter(status) {\n      const statusMap = {\n        published: \"success\",\n        draft: \"gray\",\n        deleted: \"danger\"\n      };\n      return statusMap[status];\n    }\n  },\n  data() {\n    return {\n      list: null,\n      listLoading: true,\n      supplierData: [],\n      dialogSupplierVisible: false,\n      dialogSignVisible: false,\n      signData: {\n        needSignOrgNames: [],\n        signedOrgNames: []\n      },\n      needSignCount: \"\",\n      signedCount: \"\"\n    };\n  },\n  created() {\n    this.fetchData();\n  },\n  methods: {\n    createChain() {\n      this.$router.push(\"/list/create\");\n    },\n    handleSign(index, row) {\n      const { chainId } = row;\n      checkSign(chainId).then(response => {\n        this.dialogSignVisible = true;\n        this.signData = response.data;\n        this.needSignCount = this.signData.needSignOrgNames.length;\n        this.signedCount = this.signData.signedOrgNames.length;\n      });\n    },\n    handleSupplier(index, row) {\n      this.dialogSupplierVisible = true;\n      this.supplierData = row.itemList;\n    },\n    fetchData() {\n      const id = getUserId();\n      this.listLoading = true;\n      getList(id).then(response => {\n        this.list = response.data;\n        this.listLoading = false;\n      });\n    }\n  }\n};\n</script>\n<style lang=\"scss\">\n.btn-top {\n  padding-bottom: 20px;\n}\n.btn-link {\n  color: #2d8cf0;\n}\n.individer-line {\n  padding: 0 10px;\n  color: #c2c2c2;\n}\n.el-divider--horizontal {\n  margin: 35px 0;\n}\n.el-table th {\n  background: #f8f8f9;\n  color: #515a6e;\n}\n.sign-box {\n  .need-sign-title {\n    margin-top: 20px;\n  }\n  .el-dialog__body {\n    padding-bottom: 60px;\n    padding-top: 0;\n  }\n}\n</style>\n"]}]}